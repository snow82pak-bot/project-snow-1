<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë™ë¬¼ìƒ í…ŒìŠ¤íŠ¸ ğŸ¶ğŸ±</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container { max-width: 560px; margin: 0 auto; }

        .header {
            text-align: center;
            padding: 30px 0 20px;
            color: white;
        }
        .header .emoji-row {
            font-size: 52px;
            margin-bottom: 10px;
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        .header h1 { font-size: 28px; font-weight: 800; text-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .header p { font-size: 15px; margin-top: 8px; opacity: 0.85; }

        .card {
            background: white;
            border-radius: 24px;
            padding: 28px;
            margin-top: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }

        /* Upload */
        .upload-area {
            border: 2.5px dashed #c0b5ff;
            border-radius: 16px;
            padding: 44px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: #faf9ff;
        }
        .upload-area:hover { border-color: #6c63ff; background: #f0eeff; }
        .upload-icon { font-size: 48px; margin-bottom: 12px; }
        .upload-area p { color: #888; font-size: 14px; }
        .upload-area strong { color: #6c63ff; }
        #fileInput { display: none; }

        /* Preview */
        #previewContainer { display: none; text-align: center; margin-top: 16px; }
        #previewImg {
            max-width: 100%;
            max-height: 300px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.12);
            object-fit: cover;
        }
        .change-btn {
            margin-top: 10px;
            background: none;
            border: 1.5px solid #ddd;
            border-radius: 20px;
            padding: 6px 16px;
            font-size: 13px;
            color: #888;
            cursor: pointer;
        }
        .change-btn:hover { border-color: #6c63ff; color: #6c63ff; }

        /* Analyze Button */
        #analyzeBtn {
            width: 100%;
            margin-top: 20px;
            padding: 16px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.2s;
            display: none;
        }
        #analyzeBtn:hover { opacity: 0.92; transform: translateY(-1px); }

        /* Loading */
        #loading { display: none; text-align: center; padding: 24px 0; }
        .spinner {
            width: 48px; height: 48px;
            border: 5px solid #f0eeff;
            border-top-color: #6c63ff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 12px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Result */
        #result { display: none; }

        .result-badge {
            text-align: center;
            padding: 24px;
            border-radius: 20px;
            margin-bottom: 20px;
        }
        .result-badge.dog { background: linear-gradient(135deg, #fff3e0, #ffe0b2); border: 2px solid #ffb74d; }
        .result-badge.cat { background: linear-gradient(135deg, #e8f5e9, #c8e6c9); border: 2px solid #66bb6a; }

        .result-emoji { font-size: 72px; animation: pop 0.4s cubic-bezier(0.17,0.67,0.58,1.3); }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1); } }

        .result-title { font-size: 26px; font-weight: 800; margin-top: 10px; }
        .result-badge.dog .result-title { color: #e65100; }
        .result-badge.cat .result-title { color: #2e7d32; }
        .result-sub { font-size: 14px; color: #777; margin-top: 4px; }

        /* Bars */
        .bar-item { margin-bottom: 14px; }
        .bar-label { display: flex; justify-content: space-between; font-size: 14px; font-weight: 600; margin-bottom: 6px; }
        .bar-track { background: #f0f0f5; border-radius: 100px; height: 12px; overflow: hidden; }
        .bar-fill { height: 100%; border-radius: 100px; transition: width 0.8s cubic-bezier(0.22, 1, 0.36, 1); }
        .bar-fill.dog { background: linear-gradient(90deg, #ffb74d, #ff9800); }
        .bar-fill.cat { background: linear-gradient(90deg, #66bb6a, #43a047); }

        /* Description */
        .desc-card { background: #faf9ff; border-radius: 16px; padding: 20px; margin-top: 16px; }
        .desc-card h3 { font-size: 16px; margin-bottom: 10px; color: #6c63ff; }
        .desc-card ul { list-style: none; padding: 0; }
        .desc-card ul li { padding: 6px 0; font-size: 14px; color: #555; border-bottom: 1px solid #eee; }
        .desc-card ul li:last-child { border-bottom: none; }
        .desc-card ul li::before { content: "âœ¦ "; color: #6c63ff; }

        #retryBtn {
            width: 100%;
            margin-top: 16px;
            padding: 14px;
            background: white;
            color: #6c63ff;
            border: 2px solid #6c63ff;
            border-radius: 14px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
        }
        #retryBtn:hover { background: #6c63ff; color: white; }

        .footer {
            text-align: center;
            color: rgba(255,255,255,0.6);
            font-size: 12px;
            padding: 24px 0 10px;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="emoji-row">ğŸ¶ğŸ±</div>
        <h1>ë‚˜ëŠ” ê°•ì•„ì§€ìƒ? ê³ ì–‘ì´ìƒ?</h1>
        <p>AIê°€ ë‹¹ì‹ ì˜ ì–¼êµ´ì„ ë¶„ì„í•´ ë“œë¦½ë‹ˆë‹¤</p>
    </div>

    <div class="card">
        <!-- Upload -->
        <div class="upload-area" onclick="document.getElementById('fileInput').click()" id="dropZone">
            <div class="upload-icon">ğŸ–¼ï¸</div>
            <p><strong>í´ë¦­</strong>í•˜ê±°ë‚˜ ì‚¬ì§„ì„ ëŒì–´ë‹¤ ë†“ìœ¼ì„¸ìš”</p>
            <p style="margin-top:6px; font-size:13px;">JPG, PNG, WEBP ì§€ì›</p>
        </div>
        <input type="file" id="fileInput" accept="image/*">

        <div id="previewContainer">
            <img id="previewImg" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
            <br>
            <button class="change-btn" onclick="resetUpload()">ğŸ”„ ë‹¤ë¥¸ ì‚¬ì§„ ì„ íƒ</button>
        </div>

        <button id="analyzeBtn" onclick="analyze()">ğŸ” ë™ë¬¼ìƒ ë¶„ì„í•˜ê¸°</button>

        <!-- Loading -->
        <div id="loading">
            <div class="spinner"></div>
            <p style="color:#888; font-size:14px;">AIê°€ ì—´ì‹¬íˆ ë¶„ì„ ì¤‘ì´ì—ìš”...</p>
        </div>

        <!-- Result -->
        <div id="result">
            <div class="result-badge" id="resultBadge">
                <div class="result-emoji" id="resultEmoji"></div>
                <div class="result-title" id="resultTitle"></div>
                <div class="result-sub" id="resultSub"></div>
            </div>

            <div class="bar-item">
                <div class="bar-label"><span>ğŸ¶ ê°•ì•„ì§€ìƒ</span><span id="dogPct">0%</span></div>
                <div class="bar-track"><div class="bar-fill dog" id="dogBar" style="width:0%"></div></div>
            </div>
            <div class="bar-item">
                <div class="bar-label"><span>ğŸ± ê³ ì–‘ì´ìƒ</span><span id="catPct">0%</span></div>
                <div class="bar-track"><div class="bar-fill cat" id="catBar" style="width:0%"></div></div>
            </div>

            <div class="desc-card">
                <h3 id="descTitle"></h3>
                <ul id="descList"></ul>
            </div>

            <button id="retryBtn" onclick="retry()">ğŸ” ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°</button>
        </div>
    </div>

    <div style="background:white; border-radius:24px; padding:28px; margin-top:20px; box-shadow:0 20px 60px rgba(0,0,0,0.15);">
        <div id="disqus_thread"></div>
        <script>
            (function() {
                var d = document, s = d.createElement('script');
                s.src = 'https://project-snow.disqus.com/embed.js';
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    <div class="footer">Powered by Teachable Machine &amp; TensorFlow.js</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
<script>
    const MODEL_URL = "https://teachablemachine.withgoogle.com/models/bKdeT_2zy/";

    const descriptions = {
        "ê°•ì•„ì§€ìƒ": {
            emoji: "ğŸ¶",
            sub: "ì¶©ì„±ìŠ¤ëŸ½ê³  ë”°ëœ»í•œ ë§¤ë ¥ì˜ ì†Œìœ ì",
            traits: [
                "ëˆ„êµ¬ì—ê²Œë‚˜ ì¹œê·¼í•˜ê³  í¸ì•ˆí•œ ë¶„ìœ„ê¸°ë¥¼ ì¤˜ìš”",
                "ì •ì´ ë§ê³  ì˜ë¦¬ ìˆëŠ” ì„±ê²©ì´ì—ìš”",
                "ë°ê³  ê¸ì •ì ì¸ ì—ë„ˆì§€ê°€ ë„˜ì³ìš”",
                "ì‚¬ëŒë“¤ì´ ë¨¼ì € ë‹¤ê°€ì˜¤ëŠ” íƒ€ì…ì´ì—ìš”",
                "ì›ƒì„ ë•Œ ëˆˆì´ ì´ˆìŠ¹ë‹¬ì²˜ëŸ¼ íœ˜ì–´ìš”"
            ]
        },
        "ê³ ì–‘ì´ìƒ": {
            emoji: "ğŸ±",
            sub: "ì‹ ë¹„ë¡­ê³  ì„¸ë ¨ëœ ë§¤ë ¥ì˜ ì†Œìœ ì",
            traits: [
                "ë…ë¦½ì ì´ê³  ììœ ë¡œìš´ ì˜í˜¼ì´ì—ìš”",
                "ì°¨ê°‘ê²Œ ë³´ì´ì§€ë§Œ ì•Œê³  ë³´ë©´ ë‹¤ì •í•´ìš”",
                "ì¡°ìš©í•˜ì§€ë§Œ ê°•í•œ ì¡´ì¬ê°ì´ ìˆì–´ìš”",
                "íŒ¨ì…˜ê³¼ ë¯¸ì  ê°ê°ì´ ë›°ì–´ë‚˜ìš”",
                "ëˆˆë¹› í•˜ë‚˜ë¡œ ë¶„ìœ„ê¸°ë¥¼ ì¥ì•…í•´ìš”"
            ]
        }
    };

    let model = null;

    async function loadModel() {
        if (!model) {
            model = await tmImage.load(MODEL_URL + "model.json", MODEL_URL + "metadata.json");
        }
    }

    // File input
    document.getElementById("fileInput").addEventListener("change", function(e) {
        const file = e.target.files[0];
        if (!file) return;
        loadPreview(file);
    });

    // Drag & drop
    const dropZone = document.getElementById("dropZone");
    dropZone.addEventListener("dragover", e => { e.preventDefault(); dropZone.style.background = "#ece9ff"; });
    dropZone.addEventListener("dragleave", () => { dropZone.style.background = "#faf9ff"; });
    dropZone.addEventListener("drop", e => {
        e.preventDefault();
        dropZone.style.background = "#faf9ff";
        const file = e.dataTransfer.files[0];
        if (file && file.type.startsWith("image/")) loadPreview(file);
    });

    function loadPreview(file) {
        const reader = new FileReader();
        reader.onload = ev => {
            document.getElementById("previewImg").src = ev.target.result;
            document.getElementById("dropZone").style.display = "none";
            document.getElementById("previewContainer").style.display = "block";
            document.getElementById("analyzeBtn").style.display = "block";
            document.getElementById("result").style.display = "none";
        };
        reader.readAsDataURL(file);
    }

    function resetUpload() {
        document.getElementById("fileInput").value = "";
        document.getElementById("previewContainer").style.display = "none";
        document.getElementById("dropZone").style.display = "block";
        document.getElementById("analyzeBtn").style.display = "none";
        document.getElementById("result").style.display = "none";
    }

    async function analyze() {
        document.getElementById("analyzeBtn").style.display = "none";
        document.getElementById("loading").style.display = "block";
        document.getElementById("result").style.display = "none";

        await loadModel();
        const predictions = await model.predict(document.getElementById("previewImg"));

        document.getElementById("loading").style.display = "none";
        showResult(predictions);
    }

    function showResult(predictions) {
        const sorted = [...predictions].sort((a, b) => b.probability - a.probability);
        const label = sorted[0].className;
        const info = descriptions[label] || { emoji: "ğŸ˜Š", sub: "", traits: [] };

        const dogP = Math.round((predictions.find(p => p.className === "ê°•ì•„ì§€ìƒ")?.probability ?? 0) * 100);
        const catP = Math.round((predictions.find(p => p.className === "ê³ ì–‘ì´ìƒ")?.probability ?? 0) * 100);

        const badge = document.getElementById("resultBadge");
        badge.className = "result-badge " + (label === "ê°•ì•„ì§€ìƒ" ? "dog" : "cat");
        document.getElementById("resultEmoji").textContent = info.emoji;
        document.getElementById("resultTitle").textContent = label;
        document.getElementById("resultSub").textContent = info.sub;

        document.getElementById("dogBar").style.width = "0%";
        document.getElementById("catBar").style.width = "0%";
        setTimeout(() => {
            document.getElementById("dogBar").style.width = dogP + "%";
            document.getElementById("catBar").style.width = catP + "%";
        }, 100);
        document.getElementById("dogPct").textContent = dogP + "%";
        document.getElementById("catPct").textContent = catP + "%";

        document.getElementById("descTitle").textContent = label + " íŠ¹ì§•";
        document.getElementById("descList").innerHTML = info.traits.map(t => `<li>${t}</li>`).join("");

        document.getElementById("result").style.display = "block";
    }

    function retry() {
        resetUpload();
        document.getElementById("result").style.display = "none";
        document.getElementById("loading").style.display = "none";
    }
</script>
</body>
</html>
